<!doctype html><html lang=ja><meta charset=utf-8><meta content=IE=edge http-equiv=X-UA-Compatible><meta content=True name=HandheldFriendly><meta content=width=device-width,initial-scale=1.0 name=viewport><meta name=robots><link href=https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap rel=stylesheet><link href=/theme/stylesheet/style.min.css rel=stylesheet><link rel="shortcut icon" href=https://yukisakura001.github.io/favicon.ico type=image/vnd.microsoft.icon><link href=https://yukisakura001.github.io/favicon.ico rel=icon><link href=/theme/pygments/monokai.min.css id=pygments-light-theme rel=stylesheet><link href=/theme/font-awesome/css/fontawesome.css rel=stylesheet><link href=/theme/font-awesome/css/brands.css rel=stylesheet><link href=/theme/font-awesome/css/solid.css rel=stylesheet><link rel="shortcut icon" href=favicon.ico type=image/x-icon><link href=favicon.ico rel=icon type=image/x-icon><link title="雪櫻ブログ Atom" href=/feeds/all.atom.xml rel=alternate type=application/atom+xml><meta content=yukisakura name=author><meta content="PowerShell で画像付箋アプリを作ってました。" name=description><meta content="プログラミング, 自作ツール, 効率化" name=keywords><meta content=雪櫻ブログ property=og:site_name><meta content="PowerShell で画像付箋アプリを作ってみた" property=og:title><meta content="PowerShell で画像付箋アプリを作ってました。" property=og:description><meta content=en_US property=og:locale><meta content=/powershell_app_1.html property=og:url><meta content=article property=og:type><meta content="2024-08-04 00:00:00+09:00" property=article:published_time><meta property=article:modified_time><meta content=/author/yukisakura.html property=article:author><meta content=自作ツール property=article:section><meta content=プログラミング property=article:tag><meta content=自作ツール property=article:tag><meta content=効率化 property=article:tag><meta content=/images/2024-02-18/icon.png property=og:image><title>雪櫻ブログ – PowerShell で画像付箋アプリを作ってみた</title><meta content=website property=og:type><meta content=雪櫻ブログ property=og:site_name><meta content="雪櫻ブログ | PowerShell で画像付箋アプリを作ってみた" property=og:title><meta content=https://yukisakura001.github.io//powershell_app_1.html property=og:url><meta content=https://yukisakura001.github.io/images/2024-08-04/powershell_app_1/icat.png property=og:image><body class=light-theme><aside><div><a href=/> <img alt=雪櫻のブログ src=/images/2024-02-18/icon.png title=雪櫻のブログ> </a><h1><a href=/>雪櫻のブログ</a></h1><p>雑多なブログ帳~♪<nav><ul class=list><li><a href=/pages/konoburogunitsuite.html> このブログについて </a></ul></nav><ul class=social><li><a class=sc-github href=https://github.com/yukisakura001 target=_blank> <i class="fa-brands fa-github"></i> </a><li><a class=sc-youtube href=https://www.youtube.com/@yukisakura_pc target=_blank> <i class="fa-brands fa-youtube"></i> </a><li><a class=sc-twitter href=https://twitter.com/yukisakura001 target=_blank> <i class="fa-brands fa-twitter"></i> </a><li><a class=sc-rss href=feeds/all.atom.xml target=_blank> <i class="fa-solid fa-rss"></i> </a></ul></div></aside><main><nav><a href=/>Home</a><a href=/archives.html>記事履歴</a><a href=/categories.html>カテゴリー</a><a href=/tags.html>タグ一覧</a><a href=/feeds/all.atom.xml>Atom</a></nav><article class=single><header><h1 id=powershell_app_1>PowerShell で画像付箋アプリを作ってみた</h1><p>Posted on 2024年08月04日 (日) in <a href=/category/zi-zuo-tsu-ru.html>自作ツール</a></header><div><p><img alt=アイキャッチ src=/images/2024-08-04/powershell_app_1/icat.png><h1 id=_1><font color=#ff5a09>目次</font></h1><div class=toc><ul><li><a href=#_1 rel=nofollow>目次</a><li><a href=#_2 rel=nofollow>どのようなアプリなのか</a><li><a href=#_3 rel=nofollow>コード</a><li><a href=#_4 rel=nofollow>使い方</a><li><a href=#_5 rel=nofollow>感想</a></ul></div><h1 id=_2><font color=#ff5a09>どのようなアプリなのか</font></h1><p>簡単に言うと「クリップボードの画像をウィンドウとしてデスクトップに貼り付ける」アプリです。<p>このアプリは以前 Python で作成した Yukis Army knife というソフトの「画像付箋」という機能としても作りましたが、今回少々用事があり PowerShell で作ってみました。<h1 id=_3><font color=#ff5a09>コード</font></h1><div class=highlight><pre><span></span><code><span class=o>[</span><span class=n>void</span><span class=o>]</span><span class=w> </span><span class=o>[</span><span class=n>System.Reflection.Assembly</span><span class=o>]::</span><span class=n>LoadWithPartialName</span><span class=p>(</span><span class=ss>"System.Drawing"</span><span class=p>)</span>
<span class=o>[</span><span class=n>void</span><span class=o>]</span><span class=w> </span><span class=o>[</span><span class=n>System.Reflection.Assembly</span><span class=o>]::</span><span class=n>LoadWithPartialName</span><span class=p>(</span><span class=ss>"System.Windows.Forms"</span><span class=p>)</span>
<span class=k>Add</span><span class=o>-</span><span class=n>Type</span><span class=w> </span><span class=o>-</span><span class=n>AssemblyName</span><span class=w> </span><span class=k>System</span><span class=p>.</span><span class=n>Windows</span><span class=p>.</span><span class=n>Forms</span>

<span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>[</span><span class=n>Windows.Forms.Clipboard</span><span class=o>]::</span><span class=n>ContainsImage</span><span class=p>())</span><span class=w> </span><span class=err>{</span>
<span class=w>    </span><span class=err>$</span><span class=n>img</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>[</span><span class=n>Windows.Forms.Clipboard</span><span class=o>]::</span><span class=n>GetImage</span><span class=p>()</span>
<span class=err>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=err>{</span>
<span class=w>    </span><span class=k>Write</span><span class=o>-</span><span class=k>Host</span><span class=w> </span><span class=ss>"クリップボードに画像がありません。"</span>
<span class=w>    </span><span class=k>exit</span>
<span class=err>}</span>

<span class=err>$</span><span class=n>Form</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>New</span><span class=o>-</span><span class=k>Object</span><span class=w> </span><span class=k>System</span><span class=p>.</span><span class=n>Windows</span><span class=p>.</span><span class=n>Forms</span><span class=p>.</span><span class=n>Form</span>

<span class=err>$</span><span class=n>Form</span><span class=p>.</span><span class=nc>Text</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ss>"画像付箋"</span>
<span class=err>$</span><span class=n>Form</span><span class=p>.</span><span class=n>TopMost</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>$</span><span class=k>true</span>

<span class=err>$</span><span class=n>pic</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>New</span><span class=o>-</span><span class=k>Object</span><span class=w> </span><span class=k>System</span><span class=p>.</span><span class=n>Windows</span><span class=p>.</span><span class=n>Forms</span><span class=p>.</span><span class=n>PictureBox</span>
<span class=err>$</span><span class=n>pic</span><span class=p>.</span><span class=k>Size</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>New</span><span class=o>-</span><span class=k>Object</span><span class=w> </span><span class=k>System</span><span class=p>.</span><span class=n>Drawing</span><span class=p>.</span><span class=k>Size</span><span class=p>(</span><span class=err>$</span><span class=n>img</span><span class=p>.</span><span class=n>Width</span><span class=p>,</span><span class=w> </span><span class=err>$</span><span class=n>img</span><span class=p>.</span><span class=n>Height</span><span class=p>)</span>
<span class=err>$</span><span class=n>pic</span><span class=p>.</span><span class=nc>Image</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>$</span><span class=n>img</span>
<span class=err>$</span><span class=n>pic</span><span class=p>.</span><span class=n>Location</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>New</span><span class=o>-</span><span class=k>Object</span><span class=w> </span><span class=k>System</span><span class=p>.</span><span class=n>Drawing</span><span class=p>.</span><span class=n>Point</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>)</span>
<span class=err>$</span><span class=n>pic</span><span class=p>.</span><span class=n>SizeMode</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>[</span><span class=n>System.Windows.Forms.PictureBoxSizeMode</span><span class=o>]::</span><span class=n>Zoom</span>
<span class=err>$</span><span class=n>Form</span><span class=p>.</span><span class=n>Controls</span><span class=p>.</span><span class=k>Add</span><span class=p>(</span><span class=err>$</span><span class=n>pic</span><span class=p>)</span>

<span class=err>$</span><span class=n>Form</span><span class=p>.</span><span class=n>Add_SizeChanged</span><span class=p>(</span><span class=err>{</span>
<span class=w>    </span><span class=err>$</span><span class=n>pic</span><span class=p>.</span><span class=k>Size</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>$</span><span class=n>Form</span><span class=p>.</span><span class=n>ClientSize</span>
<span class=err>}</span><span class=p>)</span>

<span class=err>$</span><span class=n>Form</span><span class=p>.</span><span class=n>ClientSize</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>New</span><span class=o>-</span><span class=k>Object</span><span class=w> </span><span class=k>System</span><span class=p>.</span><span class=n>Drawing</span><span class=p>.</span><span class=k>Size</span><span class=p>(</span><span class=err>$</span><span class=n>img</span><span class=p>.</span><span class=n>Width</span><span class=p>,</span><span class=w> </span><span class=err>$</span><span class=n>img</span><span class=p>.</span><span class=n>Height</span><span class=p>)</span>

<span class=err>$</span><span class=n>Form</span><span class=p>.</span><span class=n>Add_Shown</span><span class=p>(</span><span class=err>{$</span><span class=n>Form</span><span class=p>.</span><span class=n>Activate</span><span class=p>()</span><span class=err>}</span><span class=p>)</span>
<span class=o>[</span><span class=n>void</span><span class=o>]</span><span class=w> </span><span class=err>$</span><span class=n>Form</span><span class=p>.</span><span class=n>ShowDialog</span><span class=p>()</span>
</code></pre></div><h1 id=_4><font color=#ff5a09>使い方</font></h1><ol><li><p>スクショ撮影や画像コピーをする</p><li><p>ps1 ファイルを起動する</p><li><p>画像がウィンドウとして表示される</p></ol><h1 id=_5><font color=#ff5a09>感想</font></h1><p>正直 PowerShell で GUI を作れるとは知らなかったので驚きました。<p>ただ ps1 は bat と違って直接コマンドを実行できないので、bat から簡単に起動できるようにしたり、ショートカットを使ってタスクバーから起動できるようにするなど、使うには工夫する必要がありそうです。<p>何ができるのかはまだよく分かっていませんが、しばらく練習も兼ねてデスクトップ向けの簡易ツールは PowerShell で作ることになりそうです。</div><div class=tag-cloud><p><a href=/tag/puroguramingu.html>プログラミング</a> <a href=/tag/zi-zuo-tsu-ru.html>自作ツール</a> <a href=/tag/xiao-lu-hua.html>効率化</a></div><div class=neighbors><a class="btn float-left" title="自作の Notion テンプレート「メモ帳テンプレート」紹介" href=/notion_tool_memo.html> <i class="fa fa-angle-left"></i> Previous Post </a></div><div class=related-posts><h4>You might enjoy</h4><ul class=related-posts><li><a href=/yak_update7_1.html>Yukis Army knife ver7.1 公開</a><li><a href=/typescript_tool_kazyougaki.html>HTML+css+TypeScript で構造化した箇条書きに適切な見出しをつけるツールを作ってみた</a><li><a href=/yak_update7_0.html>Yukis Army knife ver7.0 公開</a><li><a href=/python_flet_appfirst.html>Flet で GitHub Release のダウンロード数を取得するアプリを作ってみた</a><li><a href=/yak_update6_6.html>Yukis Army knife ver6.6 公開</a></ul></div></article><footer><p>© 2024 雪櫻<p>Built with <a href=http://getpelican.com target=_blank>Pelican</a> using <a href=http://bit.ly/flex-pelican target=_blank>Flex</a> theme</footer></main><script type=application/ld+json>
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " 雪櫻ブログ ",
  "url" : "",
  "image": "/images/2024-02-18/icon.png",
  "description": ""
}
</script>